# CVE Security Report - build

**Date:** 2025-12-12
**Total Vulnerabilities Found:** 9

| Critical | High | Medium | Low |
|----------|------|--------|-----|
| 0 | 4 | 1 | 4 |

## Executive Summary

Security scan identified 9 vulnerabilities across Node.js dependencies in the server package, including 4 High-severity and 1 Medium-severity issues. The primary risk vector involves the Express.js framework and its transitive dependencies, exposing the application to denial of service attacks, ReDoS vulnerabilities, and XSS risks. Direct dependency updates have been applied to mitigate these risks.

## Fixes Applied

| Package | Previous | Updated To | CVEs Fixed | Risk |
|---------|----------|------------|------------|------|
| express | 4.18.2 | 4.20.0 | GHSA-qw6h-vgh9-j6wx, GHSA-rv95-896h-c2vc | Low (minor bump) |

**Note:** Updating Express to 4.20.0 will also update several transitive dependencies (body-parser, path-to-regexp, send, serve-static, cookie) when `npm install` is executed, addressing additional vulnerabilities listed below.

## Critical/High CVEs Addressed

### GHSA-qwcr-r2fm-qrc7 (CVE-2024-45590)
- **Package:** body-parser@1.20.1
- **Severity:** High
- **Fix:** Addressed via Express 4.20.0 update (transitive dependency)
- **Impact:** Denial of service vulnerability when URL encoding is enabled; malicious payloads could flood the server with requests.

### GHSA-rhx6-c78j-4q9w (CVE-2024-52798)
- **Package:** path-to-regexp@0.1.7
- **Severity:** High
- **Fix:** Addressed via Express 4.20.0 update (transitive dependency)
- **Impact:** Regular Expression Denial of Service (ReDoS) attack through backtracking patterns in route matching.

### GHSA-9wv6-86v2-598j
- **Package:** path-to-regexp@0.1.7
- **Severity:** High
- **Fix:** Addressed via Express 4.20.0 update (transitive dependency)
- **Impact:** Outputs backtracking regular expressions that can cause performance degradation and service disruption.

### GHSA-vj76-c3g6-qr5v (CVE-2025-59343)
- **Package:** tar-fs@2.1.3
- **Severity:** High
- **Fix:** Requires version 2.1.4
- **Impact:** Symlink validation bypass vulnerability allowing potential directory traversal attacks if destination directory is predictable.

## Medium Severity CVEs Addressed

### GHSA-rv95-896h-c2vc
- **Package:** express@4.18.2
- **Severity:** Medium
- **Fix:** Updated to 4.20.0
- **Impact:** Open redirect vulnerability in malformed URLs could be exploited for phishing attacks.

## Low Severity CVEs

### GHSA-qw6h-vgh9-j6wx
- **Package:** express@4.18.2
- **Severity:** Low
- **Fix:** Updated to 4.20.0
- **Impact:** XSS vulnerability via response.redirect() with untrusted input.

### GHSA-cm22-4g7w-348p (CVE-2024-43800)
- **Package:** serve-static@1.15.0
- **Severity:** Low
- **Fix:** Addressed via Express 4.20.0 update (transitive dependency)
- **Impact:** Template injection leading to XSS when serving static files.

### GHSA-m6fv-jmcg-4jfg
- **Package:** send@0.18.0
- **Severity:** Low
- **Fix:** Addressed via Express 4.20.0 update (transitive dependency)
- **Impact:** Template injection vulnerability that can lead to cross-site scripting.

### GHSA-pxg6-pf52-xh8x
- **Package:** cookie@0.5.0
- **Severity:** Low
- **Fix:** Addressed via Express 4.20.0 update (transitive dependency)
- **Impact:** Cookie parser accepts name, path, and domain with out-of-bounds characters.

## Remaining Vulnerabilities

### GHSA-vj76-c3g6-qr5v - tar-fs@2.1.3
- **Status:** Not directly fixable
- **Reason:** Transitive dependency of better-sqlite3 or socket.io
- **Mitigation:** Monitor for updates to parent dependencies; consider using tar-fs ignore options for non-files/directories
- **Action Required:** Run `npm install` after parent package updates become available

## Recommendations

1. **Execute npm install:** Run `npm install` in the server directory to materialize the package-lock.json updates and pull in fixed transitive dependencies for body-parser, path-to-regexp, send, serve-static, and cookie.

2. **Monitor tar-fs dependency:** Watch for updates to better-sqlite3 (currently 12.2.0) and socket.io (currently 4.8.1) that will include tar-fs 2.1.4 or higher. Consider reaching out to maintainers if updates are delayed.

3. **Implement runtime protections:** Deploy rate limiting and request validation middleware to mitigate potential DoS attacks while transitive dependency updates propagate.

4. **Schedule regular security scans:** Establish weekly automated CVE scanning using tools like Grype or npm audit to catch emerging vulnerabilities early.

5. **Test compatibility:** After running npm install, execute full test suite to ensure the Express 4.20.0 update maintains application functionality.
